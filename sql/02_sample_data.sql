-- =====================================================
-- SAAS多租户时区处理示例 - 示例数据
-- 插入多时区商户和订单数据
-- =====================================================

-- 清空现有数据（如果存在）
TRUNCATE TABLE dws_orders CASCADE;
TRUNCATE TABLE dim_merchant RESTART IDENTITY CASCADE;

-- =====================================================
-- 插入商户数据 - 覆盖全球主要时区
-- =====================================================

INSERT INTO dim_merchant (merchant_name, merchant_code, country, city, timezone, status) VALUES
-- 亚洲时区
('北京科技有限公司', 'CN_BEIJING_001', '中国', '北京', 'Asia/Shanghai', 'active'),
('东京电商株式会社', 'JP_TOKYO_001', '日本', '东京', 'Asia/Tokyo', 'active'),
('新加坡贸易公司', 'SG_SINGAPORE_001', '新加坡', '新加坡', 'Asia/Singapore', 'active'),
('首尔科技公司', 'KR_SEOUL_001', '韩国', '首尔', 'Asia/Seoul', 'active'),

-- 欧洲时区
('伦敦金融服务', 'UK_LONDON_001', '英国', '伦敦', 'Europe/London', 'active'),
('巴黎时尚集团', 'FR_PARIS_001', '法国', '巴黎', 'Europe/Paris', 'active'),
('柏林科技创新', 'DE_BERLIN_001', '德国', '柏林', 'Europe/Berlin', 'active'),
('阿姆斯特丹贸易', 'NL_AMSTERDAM_001', '荷兰', '阿姆斯特丹', 'Europe/Amsterdam', 'active'),

-- 美洲时区
('纽约金融公司', 'US_NYC_001', '美国', '纽约', 'America/New_York', 'active'),
('洛杉矶科技', 'US_LA_001', '美国', '洛杉矶', 'America/Los_Angeles', 'active'),
('芝加哥贸易', 'US_CHICAGO_001', '美国', '芝加哥', 'America/Chicago', 'active'),
('圣保罗商贸', 'BR_SAO_PAULO_001', '巴西', '圣保罗', 'America/Sao_Paulo', 'active'),
('多伦多服务', 'CA_TORONTO_001', '加拿大', '多伦多', 'America/Toronto', 'active'),

-- 大洋洲时区
('悉尼零售集团', 'AU_SYDNEY_001', '澳大利亚', '悉尼', 'Australia/Sydney', 'active'),
('奥克兰服务公司', 'NZ_AUCKLAND_001', '新西兰', '奥克兰', 'Pacific/Auckland', 'active'),

-- 特殊时区
('迪拜贸易中心', 'AE_DUBAI_001', '阿联酋', '迪拜', 'Asia/Dubai', 'active'),
('莫斯科科技', 'RU_MOSCOW_001', '俄罗斯', '莫斯科', 'Europe/Moscow', 'active');

-- =====================================================
-- 插入订单数据 - 模拟真实业务场景
-- =====================================================

-- 为了演示时区转换效果，我们创建一些在特定UTC时间的订单
-- 这样可以清楚看到同一时刻在不同时区的本地时间

-- 2024年8月19日的订单（跨越多个时区的同一时刻）
INSERT INTO dws_orders (order_no, merchant_id, order_amount, currency, order_status, order_time_utc, payment_time_utc, customer_id, customer_email, order_source) VALUES

-- UTC时间: 2024-08-19 00:00:00 的订单
('ORD_CN_20240819_001', 1, 1288.50, 'CNY', 'paid', '2024-08-19 00:00:00+00', '2024-08-19 00:05:23+00', 'CUST_001', 'zhang@example.com', 'web'),
('ORD_JP_20240819_001', 2, 15800.00, 'JPY', 'paid', '2024-08-19 00:00:00+00', '2024-08-19 00:03:45+00', 'CUST_002', 'tanaka@example.com', 'mobile'),
('ORD_US_20240819_001', 9, 299.99, 'USD', 'paid', '2024-08-19 00:00:00+00', '2024-08-19 00:02:15+00', 'CUST_003', 'john@example.com', 'web'),

-- UTC时间: 2024-08-19 06:00:00 的订单
('ORD_UK_20240819_001', 5, 156.75, 'GBP', 'paid', '2024-08-19 06:00:00+00', '2024-08-19 06:01:30+00', 'CUST_004', 'smith@example.com', 'web'),
('ORD_SG_20240819_001', 3, 450.00, 'SGD', 'shipped', '2024-08-19 06:00:00+00', '2024-08-19 06:04:20+00', 'CUST_005', 'lim@example.com', 'mobile'),
('ORD_BR_20240819_001', 12, 890.25, 'BRL', 'delivered', '2024-08-19 06:00:00+00', '2024-08-19 06:02:45+00', 'CUST_006', 'silva@example.com', 'web'),

-- UTC时间: 2024-08-19 12:00:00 的订单
('ORD_DE_20240819_001', 7, 234.80, 'EUR', 'paid', '2024-08-19 12:00:00+00', '2024-08-19 12:03:15+00', 'CUST_007', 'mueller@example.com', 'web'),
('ORD_AU_20240819_001', 14, 678.90, 'AUD', 'paid', '2024-08-19 12:00:00+00', '2024-08-19 12:05:30+00', 'CUST_008', 'johnson@example.com', 'mobile'),
('ORD_LA_20240819_001', 10, 445.60, 'USD', 'pending', '2024-08-19 12:00:00+00', NULL, 'CUST_009', 'garcia@example.com', 'web'),

-- UTC时间: 2024-08-19 18:00:00 的订单
('ORD_FR_20240819_001', 6, 189.99, 'EUR', 'paid', '2024-08-19 18:00:00+00', '2024-08-19 18:02:45+00', 'CUST_010', 'dubois@example.com', 'web'),
('ORD_KR_20240819_001', 4, 125000.00, 'KRW', 'shipped', '2024-08-19 18:00:00+00', '2024-08-19 18:01:20+00', 'CUST_011', 'kim@example.com', 'mobile'),
('ORD_CA_20240819_001', 13, 356.75, 'CAD', 'delivered', '2024-08-19 18:00:00+00', '2024-08-19 18:04:10+00', 'CUST_012', 'martin@example.com', 'web'),

-- 跨日期的订单（展示日期边界处理）
-- UTC时间: 2024-08-19 23:30:00 的订单
('ORD_NZ_20240819_001', 15, 299.50, 'NZD', 'paid', '2024-08-19 23:30:00+00', '2024-08-19 23:32:15+00', 'CUST_013', 'wilson@example.com', 'web'),
('ORD_RU_20240819_001', 17, 12500.00, 'RUB', 'paid', '2024-08-19 23:30:00+00', '2024-08-19 23:35:45+00', 'CUST_014', 'petrov@example.com', 'mobile'),

-- 第二天的订单
-- UTC时间: 2024-08-20 02:00:00 的订单
('ORD_AE_20240820_001', 16, 750.25, 'AED', 'paid', '2024-08-20 02:00:00+00', '2024-08-20 02:03:30+00', 'CUST_015', 'ahmed@example.com', 'web'),
('ORD_NL_20240820_001', 8, 445.80, 'EUR', 'shipped', '2024-08-20 02:00:00+00', '2024-08-20 02:01:45+00', 'CUST_016', 'van@example.com', 'mobile'),

-- 更多历史订单数据（用于统计分析）
-- 2024年8月18日的订单
('ORD_CN_20240818_001', 1, 2156.80, 'CNY', 'delivered', '2024-08-18 08:00:00+00', '2024-08-18 08:02:30+00', 'CUST_017', 'li@example.com', 'web'),
('ORD_US_20240818_001', 9, 1299.99, 'USD', 'delivered', '2024-08-18 14:00:00+00', '2024-08-18 14:05:15+00', 'CUST_018', 'davis@example.com', 'web'),
('ORD_UK_20240818_001', 5, 567.45, 'GBP', 'delivered', '2024-08-18 10:00:00+00', '2024-08-18 10:03:20+00', 'CUST_019', 'brown@example.com', 'mobile'),

-- 2024年8月17日的订单
('ORD_JP_20240817_001', 2, 25600.00, 'JPY', 'delivered', '2024-08-17 05:00:00+00', '2024-08-17 05:04:45+00', 'CUST_020', 'sato@example.com', 'web'),
('ORD_DE_20240817_001', 7, 789.90, 'EUR', 'delivered', '2024-08-17 11:00:00+00', '2024-08-17 11:02:15+00', 'CUST_021', 'schmidt@example.com', 'mobile'),
('ORD_AU_20240817_001', 14, 1234.56, 'AUD', 'delivered', '2024-08-17 22:00:00+00', '2024-08-17 22:06:30+00', 'CUST_022', 'taylor@example.com', 'web');

-- =====================================================
-- 示例数据插入完成
-- =====================================================

-- 示例数据插入完成！
-- 已插入17个不同时区的商户数据
-- 已插入22条订单数据，覆盖多个时间点和日期边界场景